# Supabase Environment Migration Template
# Copy this file and set the appropriate values for your migration

# =============================================================================
# SOURCE PROJECT (Export From)
# =============================================================================

# Old project details
OLD_PROJECT_REF="your-old-project-ref"
OLD_PROJECT_URL="https://your-old-project.supabase.co"
OLD_SERVICE_ROLE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
OLD_DB_PASSWORD="your-old-database-password"

# =============================================================================
# TARGET PROJECT (Import To)
# =============================================================================

# New project details
NEW_PROJECT_REF="your-new-project-ref"
NEW_PROJECT_URL="https://your-new-project.supabase.co"
NEW_SERVICE_ROLE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
NEW_DB_PASSWORD="your-new-database-password"

# =============================================================================
# API ACCESS
# =============================================================================

# Personal access token (get from https://supabase.com/dashboard/account/tokens)
SUPABASE_ACCESS_TOKEN="sbp_..."

# =============================================================================
# MIGRATION OPTIONS
# =============================================================================

# Storage migration options
SKIP_EXISTING_OBJECTS="true"           # Skip objects that already exist
STORAGE_BATCH_SIZE="5"                 # Number of concurrent uploads
STORAGE_MAX_FILE_SIZE="50MB"           # Skip files larger than this

# Database migration options
INCLUDE_MIGRATION_HISTORY="true"       # Preserve CLI migration history
EXPORT_AUTH_SCHEMA="false"             # Export custom auth schema changes
EXPORT_STORAGE_SCHEMA="false"          # Export custom storage schema changes

# Function migration options
DEPLOY_FUNCTIONS_AFTER_EXPORT="false"  # Auto-deploy functions to new project

# =============================================================================
# LOGGING AND REPORTING
# =============================================================================

# Log levels: error, warn, info, debug
LOG_LEVEL="info"

# Generate detailed reports
GENERATE_REPORTS="true"

# =============================================================================
# CLERK INTEGRATION (For SaaS Template)
# =============================================================================

# Original Clerk configuration (for documentation)
# These need to be manually recreated in the new project
CLERK_PUBLISHABLE_KEY="pk_live_..."
CLERK_SECRET_KEY="sk_live_..."

# JWT Template Settings (to be recreated manually)
# See README.md for the exact JWT template configuration

# =============================================================================
# APPLICATION ENVIRONMENT VARIABLES
# =============================================================================

# These will need to be updated after migration
NEXT_PUBLIC_SUPABASE_URL="${NEW_PROJECT_URL}"
NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
SUPABASE_SERVICE_ROLE_KEY="${NEW_SERVICE_ROLE_KEY}"

# Clerk configuration (update after migration)
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY="${CLERK_PUBLISHABLE_KEY}"
CLERK_SECRET_KEY="${CLERK_SECRET_KEY}"
NEXT_PUBLIC_CLERK_SIGN_UP_FORCE_REDIRECT_URL="/onboarding"
NEXT_PUBLIC_CLERK_SIGN_IN_FORCE_REDIRECT_URL="/dashboard"

# Optional: Cron job security
CRON_SECRET="your-secure-cron-secret"

# Optional: Monitoring (update project references)
NEXT_PUBLIC_SENTRY_DSN="your-sentry-dsn"

# =============================================================================
# VERIFICATION SETTINGS
# =============================================================================

# Tables to verify data integrity after migration
VERIFY_TABLES="profiles,tenants,organizations,organization_memberships"

# Sample size for data verification (set to 0 for all records)
VERIFY_SAMPLE_SIZE="1000"

# =============================================================================
# ROLLBACK SETTINGS
# =============================================================================

# Keep backup of original data before import (recommended)
CREATE_BACKUP_BEFORE_IMPORT="true"

# Rollback timeout (how long to wait before auto-rollback on failure)
ROLLBACK_TIMEOUT_MINUTES="30"

# =============================================================================
# USAGE INSTRUCTIONS
# =============================================================================

# 1. Copy this file to .env.migration
# 2. Fill in all the required values
# 3. Run: source .env.migration
# 4. Execute the export scripts:
#    ./export-database.sh
#    node migrate-storage.js
#    ./export-functions.sh
# 5. Set up your new project
# 6. Run the import scripts
# 7. Verify the migration

# =============================================================================
# SECURITY NOTES
# =============================================================================

# - Never commit this file with real credentials
# - Use environment-specific files (.env.staging, .env.production)
# - Rotate access tokens after migration
# - Update webhook URLs in external services
# - Test all integrations after migration